<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Baseline estimator. — baseline_est • attrib</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Baseline estimator. — baseline_est" />
<meta property="og:description" content="Baseline estimator for mortality. If a random effect is present the negative binomial distribution is used.
Otherwise a quisipoisson is fitted to the data.
We use simmulations to generate n_sim responses for each row in the dataset to create a baseline." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">attrib</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2021.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/intro.html">Introduction to Attrib</a>
    </li>
    <li>
      <a href="../articles/nowcast.html">Nowcasting with Attrib</a>
    </li>
    <li>
      <a href="../articles/statistical_properties.html">Statistical properties used in Attrib</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/folkehelseinstituttet/attrib/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Baseline estimator.</h1>
    <small class="dont-index">Source: <a href='https://github.com/folkehelseinstituttet/attrib/blob/master/R/baseline_est.R'><code>R/baseline_est.R</code></a></small>
    <div class="hidden name"><code>baseline_est.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Baseline estimator for mortality. If a random effect is present the negative binomial distribution is used.
Otherwise a quisipoisson is fitted to the data.
We use simmulations to generate n_sim responses for each row in the dataset to create a baseline.</p>
    </div>

    <pre class="usage"><span class='fu'>baseline_est</span><span class='op'>(</span>
  <span class='va'>data_train</span>,
  <span class='va'>data_predict</span>,
  n_sim <span class='op'>=</span> <span class='fl'>1000</span>,
  <span class='va'>fixef</span>,
  <span class='va'>ranef</span>,
  <span class='va'>response</span>,
  <span class='va'>offset</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data_train</th>
      <td><p>Data to train on.</p></td>
    </tr>
    <tr>
      <th>data_predict</th>
      <td><p>Data to predict on</p></td>
    </tr>
    <tr>
      <th>n_sim</th>
      <td><p>number of simulations to preform. Default setting is n_sim = 1000</p></td>
    </tr>
    <tr>
      <th>fixef</th>
      <td><p>Fixed effekts</p></td>
    </tr>
    <tr>
      <th>ranef</th>
      <td><p>Random effekts, default is NULL</p></td>
    </tr>
    <tr>
      <th>response</th>
      <td><p>Response</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>Offset, can be NULL</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Residualplots for all ncor_i and some evaluationmetrixs for each of them as well as a plot containing credible intervals using the simulation</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For more details see the help vignette:
<code><a href='../articles/nowcast.html'>vignette("nowcast", package="attrib")</a></code></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'>as.data.table</span><span class='op'>(</span><span class='va'>data_fake_nowcasting_county_aggregated</span><span class='op'>)</span>
<span class='va'>n_sim</span> <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='va'>fixef</span> <span class='op'>&lt;-</span> <span class='st'>"sin(2 * pi * (week) / 53) + cos(2 * pi * (week ) / 53) + year"</span>
<span class='va'>ranef</span> <span class='op'>&lt;-</span> <span class='st'>"(1|location_code)"</span>
<span class='va'>response</span> <span class='op'>&lt;-</span> <span class='st'>"n_death"</span>
<span class='va'>data_train</span> <span class='op'>&lt;-</span> <span class='va'>data</span><span class='op'>[</span><span class='va'>cut_doe</span><span class='op'>&lt;</span> <span class='st'>"2019-06-30"</span><span class='op'>]</span>
<span class='va'>data_predict</span> <span class='op'>&lt;-</span> <span class='va'>data</span>
<span class='va'>offset</span> <span class='op'>&lt;-</span> <span class='st'>"log(pop)"</span>
<span class='fu'>baseline_est</span><span class='op'>(</span><span class='va'>data_train</span>, <span class='va'>data_predict</span>, n_sim <span class='op'>=</span> <span class='fl'>1000</span>, <span class='va'>fixef</span>, <span class='va'>ranef</span>, <span class='va'>response</span>, <span class='va'>offset</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html'>as.data.table</a></span><span class='op'>(</span><span class='va'>data_fake_nowcasting_county_aggregated</span><span class='op'>)</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>data</span><span class='op'>[</span><span class='va'>location_code</span> <span class='op'>==</span> <span class='st'>"county03"</span><span class='op'>]</span>
<span class='va'>n_sim</span> <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='va'>fixef</span> <span class='op'>&lt;-</span> <span class='st'>"sin(2 * pi * (week) / 53) + cos(2 * pi * (week ) / 53) + year"</span>
<span class='va'>ranef</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
<span class='va'>response</span> <span class='op'>&lt;-</span> <span class='st'>"n_death"</span>
<span class='va'>data_train</span> <span class='op'>&lt;-</span> <span class='va'>data</span><span class='op'>[</span><span class='va'>cut_doe</span><span class='op'>&lt;</span> <span class='st'>"2019-06-30"</span><span class='op'>]</span>
<span class='va'>data_predict</span> <span class='op'>&lt;-</span> <span class='va'>data</span>
<span class='va'>offset</span> <span class='op'>&lt;-</span> <span class='st'>"log(pop)"</span>
<span class='fu'>baseline_est</span><span class='op'>(</span><span class='va'>data_train</span>, <span class='va'>data_predict</span>, n_sim <span class='op'>=</span> <span class='fl'>1000</span>, <span class='va'>fixef</span>, <span class='va'>ranef</span>, <span class='va'>response</span>, <span class='va'>offset</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $simulations
#&gt;            cut_doe location_code n_death n0_0 p0_0 n0_1 p0_1 n0_2 p0_2 n0_3
#&gt;      1: 2018-01-01      county03      10    0    0    4  0.4    9  0.9   10
#&gt;      2: 2018-01-01      county03      10    0    0    4  0.4    9  0.9   10
#&gt;      3: 2018-01-01      county03      10    0    0    4  0.4    9  0.9   10
#&gt;      4: 2018-01-01      county03      10    0    0    4  0.4    9  0.9   10
#&gt;      5: 2018-01-01      county03      10    0    0    4  0.4    9  0.9   10
#&gt;     ---                                                                    
#&gt; 102996: 2019-12-16      county03       1    0    0   NA   NA   NA   NA   NA
#&gt; 102997: 2019-12-16      county03       1    0    0   NA   NA   NA   NA   NA
#&gt; 102998: 2019-12-16      county03       1    0    0   NA   NA   NA   NA   NA
#&gt; 102999: 2019-12-16      county03       1    0    0   NA   NA   NA   NA   NA
#&gt; 103000: 2019-12-16      county03       1    0    0   NA   NA   NA   NA   NA
#&gt;         p0_3 n0_4 p0_4 n0_5 p0_5 week year    pop id_row sim_id sim_value
#&gt;      1:    1   10    1   10    1    1 2018 664234      1      1        10
#&gt;      2:    1   10    1   10    1    1 2018 664234      1      2        12
#&gt;      3:    1   10    1   10    1    1 2018 664234      1      3         8
#&gt;      4:    1   10    1   10    1    1 2018 664234      1      4        14
#&gt;      5:    1   10    1   10    1    1 2018 664234      1      5         9
#&gt;     ---                                                                  
#&gt; 102996:   NA   NA   NA   NA   NA   51 2019 672069    103    996        16
#&gt; 102997:   NA   NA   NA   NA   NA   51 2019 672069    103    997        11
#&gt; 102998:   NA   NA   NA   NA   NA   51 2019 672069    103    998         7
#&gt; 102999:   NA   NA   NA   NA   NA   51 2019 672069    103    999        16
#&gt; 103000:   NA   NA   NA   NA   NA   51 2019 672069    103   1000         9
#&gt;                  type
#&gt;      1: quasi_poisson
#&gt;      2: quasi_poisson
#&gt;      3: quasi_poisson
#&gt;      4: quasi_poisson
#&gt;      5: quasi_poisson
#&gt;     ---              
#&gt; 102996: quasi_poisson
#&gt; 102997: quasi_poisson
#&gt; 102998: quasi_poisson
#&gt; 102999: quasi_poisson
#&gt; 103000: quasi_poisson
#&gt; 
#&gt; $aggregated
#&gt;         cut_doe location_code n_death n0_0 p0_0 n0_1       p0_1 n0_2      p0_2
#&gt;   1: 2018-01-01      county03      10    0    0    4 0.40000000    9 0.9000000
#&gt;   2: 2018-01-08      county03       6    0    0    0 0.00000000    3 0.5000000
#&gt;   3: 2018-01-15      county03      16    0    0    3 0.18750000   11 0.6875000
#&gt;   4: 2018-01-22      county03      12    0    0    2 0.16666667   11 0.9166667
#&gt;   5: 2018-01-29      county03       8    0    0    1 0.12500000    6 0.7500000
#&gt;  ---                                                                          
#&gt;  99: 2019-11-18      county03      16    0    0    3 0.18750000   14 0.8750000
#&gt; 100: 2019-11-25      county03      12    0    0    1 0.08333333   10 0.8333333
#&gt; 101: 2019-12-02      county03      14    0    0    1 0.07142857   11 0.7857143
#&gt; 102: 2019-12-09      county03       9    0    0    3 0.33333333   NA        NA
#&gt; 103: 2019-12-16      county03       1    0    0   NA         NA   NA        NA
#&gt;      n0_3      p0_3 n0_4 p0_4 n0_5 p0_5 week year    pop id_row          type
#&gt;   1:   10 1.0000000   10    1   10    1    1 2018 664234      1 quasi_poisson
#&gt;   2:    6 1.0000000    6    1    6    1    2 2018 664234      2 quasi_poisson
#&gt;   3:   16 1.0000000   16    1   16    1    3 2018 664234      3 quasi_poisson
#&gt;   4:   12 1.0000000   12    1   12    1    4 2018 664234      4 quasi_poisson
#&gt;   5:    8 1.0000000    8    1    8    1    5 2018 664234      5 quasi_poisson
#&gt;  ---                                                                         
#&gt;  99:   16 1.0000000   16    1   NA   NA   47 2019 672069     99 quasi_poisson
#&gt; 100:   11 0.9166667   NA   NA   NA   NA   48 2019 672069    100 quasi_poisson
#&gt; 101:   NA        NA   NA   NA   NA   NA   49 2019 672069    101 quasi_poisson
#&gt; 102:   NA        NA   NA   NA   NA   NA   50 2019 672069    102 quasi_poisson
#&gt; 103:   NA        NA   NA   NA   NA   NA   51 2019 672069    103 quasi_poisson
#&gt;      median.sim_value q025.sim_value q975.sim_value
#&gt;   1:               13          6.000         21.000
#&gt;   2:               13          7.000         21.000
#&gt;   3:               13          6.975         20.025
#&gt;   4:               13          6.000         21.000
#&gt;   5:               13          6.000         21.000
#&gt;  ---                                               
#&gt;  99:               12          6.000         20.025
#&gt; 100:               12          6.000         21.000
#&gt; 101:               13          6.000         20.000
#&gt; 102:               13          6.000         20.000
#&gt; 103:               13          6.000         21.000
#&gt; 
#&gt; $fit
#&gt; 
#&gt; Call:  stats::glm(formula = stats::as.formula(formula), family = "quasipoisson", 
#&gt;     data = data_train)
#&gt; 
#&gt; Coefficients:
#&gt;             (Intercept)  sin(2 * pi * (week)/53)  cos(2 * pi * (week)/53)  
#&gt;               -28.25089                  0.04186                  0.02288  
#&gt;                    year                 log(pop)  
#&gt;                 0.01525                       NA  
#&gt; 
#&gt; Degrees of Freedom: 77 Total (i.e. Null);  74 Residual
#&gt; Null Deviance:	    56.67 
#&gt; Residual Deviance: 55.39 	AIC: NA
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Richard Aubrey White, Aurora Christine Hofman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


